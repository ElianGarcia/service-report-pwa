"use strict";(self.webpackChunkservice_report_pwa=self.webpackChunkservice_report_pwa||[]).push([[25],{5373:(W,Z,a)=>{a.r(Z),a.d(Z,{AuthModule:()=>$});var g=a(6895),u=a(9299),r=a(4006),t=a(4650),p=a(678),d=a(4961),f=a(14),h=a(7392),l=a(9549),_=a(4144),v=a(4859);function k(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function F(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function U(o,s){1&o&&(t.TgZ(0,"ion-chip",17),t._uU(1,"Incorrect username or password."),t.qZA())}const y=function(){return["/auth/register"]};let b=(()=>{class o{constructor(e,n,i,m){this.fb=e,this.modal=n,this.userService=i,this.router=m,this.invalidLogin=!1}ngOnInit(){this.mainForm=this.fb.group({username:["",[r.kI.required]],password:["",[r.kI.required]]}),this.userService.isUserAuthenticated()&&this.router.navigateByUrl("")}getError(e){return null!=this.mainForm.get(e)&&this.mainForm.get(e).hasError("required")?`The ${e} field is mandatory.`:""}login(){this.invalidLogin=!1,this.mainForm.valid?this.userService.login(this.mainForm.value).subscribe(e=>{const i=e.user;localStorage.setItem("jwt",e.token),localStorage.setItem("user",JSON.stringify(i)),this.invalidLogin=!1,this.router.navigate([""])},e=>{console.log(e),(e.status=401)?this.invalidLogin=!0:this.modal.showMessage("An error has occured. Please try again later. "+e)}):this.modal.showMessage("Please fill all the fields!")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(p.Z),t.Y36(d.f),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:30,vars:10,consts:[[3,"title","showMenu"],[1,"container","col-md-8","pb-5","mt-5"],[1,"row"],[1,"col-12","d-flex","justify-content-center"],[1,"col-md-8",3,"formGroup"],[1,"col-12","mt-3"],["matInput","","type","text","formControlName","username"],["matSuffix","","mat-icon-button","","aria-label","Clear","tabindex","-1",3,"click",4,"ngIf"],[1,"col-12","mt-2"],["matInput","","type","password","formControlName","password",3,"keyup.enter"],["color","danger","class","mb-2",4,"ngIf"],[1,"row","justify-content-end","m-3"],["type","submit","value","Login",1,"col-4","btn","d-block","btn-dark",3,"click"],[1,"row","justify-content-around"],["href","mailto:eliangarciarguez@gmail.com?subject=password%20reset&body=I%20would%20like%20to%20reset%20my%20password.",1,"text-start","col-5"],["routerLinkActive","router-link-active","href","javascript:void(0)",1,"text-end","col-5",3,"routerLink"],["matSuffix","","mat-icon-button","","aria-label","Clear","tabindex","-1",3,"click"],["color","danger",1,"mb-2"]],template:function(e,n){1&e&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1"),t._uU(6,"Login"),t.qZA(),t.TgZ(7,"mat-form-field",5)(8,"mat-label"),t._uU(9,"Username"),t.qZA(),t._UZ(10,"input",6),t.YNc(11,k,3,0,"button",7),t.TgZ(12,"mat-error"),t._uU(13),t.qZA()(),t.TgZ(14,"mat-form-field",8)(15,"mat-label"),t._uU(16,"Password"),t.qZA(),t.TgZ(17,"input",9),t.NdJ("keyup.enter",function(){return n.login()}),t.qZA(),t.YNc(18,F,3,0,"button",7),t.TgZ(19,"mat-error"),t._uU(20),t.qZA()(),t.YNc(21,U,2,0,"ion-chip",10),t._UZ(22,"hr"),t.TgZ(23,"div",11)(24,"input",12),t.NdJ("click",function(){return n.login()}),t.qZA()(),t.TgZ(25,"span",13)(26,"a",14),t._uU(27,"Forgot Password?"),t.qZA(),t.TgZ(28,"a",15),t._uU(29,"New User?"),t.qZA()()()()()()),2&e&&(t.Q6J("title","Login")("showMenu",!1),t.xp6(4),t.Q6J("formGroup",n.mainForm),t.xp6(7),t.Q6J("ngIf",n.mainForm.get("username").value),t.xp6(2),t.hij(" ",n.getError("username")," "),t.xp6(5),t.Q6J("ngIf",n.mainForm.get("password").value),t.xp6(2),t.hij(" ",n.getError("password")," "),t.xp6(1),t.Q6J("ngIf",n.invalidLogin),t.xp6(7),t.Q6J("routerLink",t.DdM(9,y)))},dependencies:[g.O5,u.yS,u.Od,f.G,h.Hw,l.TO,l.KE,l.hX,l.R9,_.Nt,v.lW,r.Fj,r.JJ,r.JL,r.sg,r.u]}),o})();function A(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}const I=function(){return["/auth/login"]};let q=(()=>{class o{constructor(e,n,i,m){this.fb=e,this.modal=n,this.userService=i,this.router=m}ngOnInit(){this.mainForm=this.fb.group({mail:["",[r.kI.required,r.kI.email]]})}getError(e){if(null!=this.mainForm.get(e)){if(this.mainForm.get(e).hasError("required"))return`El campo ${e} es obligatorio.`;if(this.mainForm.get(e).hasError("email"))return`El campo ${e} debe ser un email v\xe1lido.`}return""}sendMail(){this.mainForm.valid?this.userService.sendRecoveryMail(this.mainForm.get("mail").value).subscribe(e=>{console.log(e),this.modal.showMessage("Email sent successfully!"),this.router.navigate(["/login"])},e=>{console.log(e),this.modal.showMessage("Error sending email!")}):this.modal.showMessage("Please fill all the fields!")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(p.Z),t.Y36(d.f),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-password-forgot"]],decls:21,vars:6,consts:[[3,"title"],[1,"container","col-md-8","pb-5","mt-5"],[1,"row"],[1,"col-12","d-flex","justify-content-center"],[1,"col-md-8",3,"formGroup"],[1,"col-12","mt-3"],["matInput","","type","text","formControlName","mail"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[1,"row","justify-content-around","m-3"],["routerLinkActive","router-link-active",1,"col-5","btn","btn-outline-dark",3,"routerLink"],["type","submit","value","Send Code",1,"col-5","btn","d-block","btn-dark",3,"click"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(e,n){1&e&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1"),t._uU(6,"Password Recovery"),t.qZA(),t.TgZ(7,"span"),t._uU(8," Please enter your email address. We will send you a mail to help you reset your password. "),t.qZA(),t.TgZ(9,"mat-form-field",5)(10,"mat-label"),t._uU(11,"Email"),t.qZA(),t._UZ(12,"input",6),t.YNc(13,A,3,0,"button",7),t.TgZ(14,"mat-error"),t._uU(15),t.qZA()(),t._UZ(16,"hr"),t.TgZ(17,"div",8)(18,"button",9),t._uU(19,"Back to Login"),t.qZA(),t.TgZ(20,"input",10),t.NdJ("click",function(){return n.sendMail()}),t.qZA()()()()()()),2&e&&(t.Q6J("title","Password Recovery"),t.xp6(4),t.Q6J("formGroup",n.mainForm),t.xp6(9),t.Q6J("ngIf",n.mainForm.get("mail").value),t.xp6(2),t.hij(" ",n.getError("mail")," "),t.xp6(3),t.Q6J("routerLink",t.DdM(5,I)))},dependencies:[g.O5,u.rH,u.Od,f.G,h.Hw,l.TO,l.KE,l.hX,l.R9,_.Nt,v.lW,r.Fj,r.JJ,r.JL,r.sg,r.u]}),o})();function x(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function J(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}const E=function(){return["/auth/login"]};let S=(()=>{class o{constructor(e,n,i,m){this.fb=e,this.modal=n,this.userService=i,this.router=m,this.invalidLogin=!1}ngOnInit(){this.mainForm=this.fb.group({password:["",[r.kI.required]],passwordConfirm:["",[r.kI.required]]}),this.userService.isUserAuthenticated()&&this.router.navigateByUrl("")}reset(){this.invalidLogin=!1,this.mainForm.valid?this.userService.login(this.mainForm.value).subscribe(e=>{console.log(e);const i=e.user;localStorage.setItem("jwt",e.token),localStorage.setItem("user",JSON.stringify(i)),this.invalidLogin=!1,this.router.navigate([""])},e=>{console.log(e),(e.status=401)&&(this.invalidLogin=!0)}):this.modal.showMessage("Please fill all the fields!")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(p.Z),t.Y36(d.f),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-password-reset"]],decls:28,vars:8,consts:[[3,"title"],[1,"container","col-md-8","pb-5","mt-5"],[1,"row"],[1,"col-12","d-flex","justify-content-center"],[1,"col-md-8",3,"formGroup"],[1,"col-12","mt-3"],["matInput","","type","password","formControlName","password"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["matInput","","type","password","formControlName","passwordConfirm"],[1,"row","justify-content-around","m-3"],["routerLinkActive","router-link-active",1,"col-5","btn","btn-outline-dark",3,"routerLink"],["type","submit","value","Set password",1,"col-5","btn","d-block","btn-dark",3,"click"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(e,n){1&e&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1"),t._uU(6,"Password Reset"),t.qZA(),t.TgZ(7,"span"),t._uU(8," Please enter your new password. Please try to make it as strong as possible as it will be used to keep your data safe. "),t.qZA(),t.TgZ(9,"mat-form-field",5)(10,"mat-label"),t._uU(11,"Password"),t.qZA(),t._UZ(12,"input",6),t.YNc(13,x,3,0,"button",7),t.TgZ(14,"mat-error"),t._uU(15),t.qZA()(),t.TgZ(16,"mat-form-field",5)(17,"mat-label"),t._uU(18,"Confirm the password"),t.qZA(),t._UZ(19,"input",8),t.YNc(20,J,3,0,"button",7),t.TgZ(21,"mat-error"),t._uU(22),t.qZA()(),t._UZ(23,"hr"),t.TgZ(24,"div",9)(25,"button",10),t._uU(26,"Back to Login"),t.qZA(),t.TgZ(27,"input",11),t.NdJ("click",function(){return n.reset()}),t.qZA()()()()()()),2&e&&(t.Q6J("title","Password Reset"),t.xp6(4),t.Q6J("formGroup",n.mainForm),t.xp6(9),t.Q6J("ngIf",n.mainForm.get("password").value),t.xp6(2),t.hij(" ",n.mainForm.get("password").errors," "),t.xp6(5),t.Q6J("ngIf",n.mainForm.get("passwordConfirm").value),t.xp6(2),t.hij(" ",n.mainForm.get("passwordConfirm").errors," "),t.xp6(3),t.Q6J("routerLink",t.DdM(7,E)))},dependencies:[g.O5,u.rH,u.Od,f.G,h.Hw,l.TO,l.KE,l.hX,l.R9,_.Nt,v.lW,r.Fj,r.JJ,r.JL,r.sg,r.u]}),o})();var C=a(1135),T=a(925),w=a(529);let L=(()=>{class o{constructor(e){this.httpClient=e,this._congregations=new C.X([])}getCongregations(){return this.httpClient.get(T.Cq.GETCONGREGATIONS).subscribe(e=>{this._congregations.next(e)},e=>{}),this._congregations.asObservable()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(w.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),R=(()=>{class o{constructor(e){this.httpClient=e,this._countries=new C.X([])}getCountries(){return this.httpClient.get(T.Cq.GETCOUNTRIES).subscribe(e=>{this._countries.next(e)},e=>{}),this._countries.asObservable()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(w.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var M=a(4385),N=a(3238);function P(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function Y(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function j(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function O(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.value="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function G(o,s){if(1&o&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.congregationId),t.xp6(1),t.Oqu(e.name)}}function Q(o,s){if(1&o&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.countryId),t.xp6(1),t.Oqu(e.name)}}const H=function(){return["/auth/login"]},K=[{path:"",component:b},{path:"login",component:b},{path:"register",component:(()=>{class o{constructor(e,n,i,m,z,D){this.fb=e,this.modal=n,this.userService=i,this.router=m,this.congregationService=z,this.countryService=D,this.invalidLogin=!1,this.congregationService.getCongregations().subscribe(c=>{this.congregations=c},c=>{console.log(c)}),this.countryService.getCountries().subscribe(c=>{this.countries=c},c=>{console.log(c)})}ngOnInit(){this.mainForm=this.fb.group({userId:[0,[r.kI.required]],name:["",[r.kI.required]],email:["",[r.kI.required,r.kI.email]],username:["",[r.kI.required]],password:["",[r.kI.required]],isAdmin:[!1,[r.kI.required]],congregationId:["",[r.kI.required]],countryId:["",[r.kI.required]],active:[!0,[r.kI.required]]}),this.userService.isUserAuthenticated()&&this.router.navigateByUrl("")}getError(e){if(null!=this.mainForm.get(e)){if(this.mainForm.get(e).hasError("required"))return`El campo ${e} es obligatorio.`;if(this.mainForm.get(e).hasError("email"))return`El campo ${e} debe ser un email v\xe1lido.`;if(this.mainForm.get(e).hasError("minlength"))return`El campo ${e} debe tener como m\xednimo 8 caracteres.`;if(this.mainForm.get(e).hasError("minlength"))return`El campo ${e} debe tener como m\xednimo 11 caracteres.`}return""}userExists(){return this.userService.login(this.mainForm.value).subscribe(e=>!!e,e=>(console.log(e),!1)),!1}register(){this.invalidLogin=!1,this.mainForm.valid?this.userExists()?this.modal.showMessage("El usuario ya existe!"):this.userService.register(this.mainForm.value).subscribe(e=>{console.log(e),this.modal.showMessage("User registered successfully!"),this.router.navigate(["auth/login"])},e=>{console.log(e),this.modal.showMessage("Error registering user!")}):this.modal.showMessage("Please fill all the fields!")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(p.Z),t.Y36(d.f),t.Y36(u.F0),t.Y36(L),t.Y36(R))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-register"]],decls:67,vars:16,consts:[[3,"title"],[1,"container","col-md-8","pb-5","mt-5"],[1,"row"],[1,"col-12","d-flex","justify-content-center"],[1,"col-md-8",3,"formGroup"],[1,"col-xl-6","col-md-12","col-sm-12"],["matInput","","type","text","formControlName","name"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[1,"col-xl-6","col-md-12"],["matInput","","type","email","formControlName","email"],["matInput","","type","text","formControlName","username"],["matInput","","type","password","formControlName","password"],["formControlName","congregationId"],[3,"value",4,"ngFor","ngForOf"],["href","mailto:eliangarciarguez@gmail.com"],[1,"col-xl-12","col-md-12","col-sm-12"],["formControlName","countryId"],[1,"row","justify-content-around","m-3"],["type","submit","value","Back to Login","routerLinkActive","router-link-active",1,"col-4","btn","d-block","btn-dark",3,"routerLink"],["type","submit","value","Sign up",1,"col-4","btn","d-block","btn-dark",3,"click"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value"]],template:function(e,n){1&e&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1"),t._uU(6,"Sign up"),t.qZA(),t.TgZ(7,"div",2)(8,"mat-form-field",5)(9,"mat-label"),t._uU(10,"Name"),t.qZA(),t._UZ(11,"input",6),t.YNc(12,P,3,0,"button",7),t.TgZ(13,"mat-error"),t._uU(14),t.qZA()(),t.TgZ(15,"mat-form-field",8)(16,"mat-label"),t._uU(17,"Email"),t.qZA(),t._UZ(18,"input",9),t.YNc(19,Y,3,0,"button",7),t.TgZ(20,"mat-error"),t._uU(21),t.qZA()()(),t.TgZ(22,"div",2)(23,"mat-form-field",5)(24,"mat-label"),t._uU(25,"Username"),t.qZA(),t._UZ(26,"input",10),t.YNc(27,j,3,0,"button",7),t.TgZ(28,"mat-error"),t._uU(29),t.qZA()(),t.TgZ(30,"mat-form-field",8)(31,"mat-label"),t._uU(32,"Password"),t.qZA(),t._UZ(33,"input",11),t.YNc(34,O,3,0,"button",7),t.TgZ(35,"mat-error"),t._uU(36),t.qZA()()(),t.TgZ(37,"div",2)(38,"mat-form-field",5)(39,"mat-label"),t._uU(40,"Congregation"),t.qZA(),t.TgZ(41,"mat-select",12)(42,"mat-option"),t._uU(43,"Clear"),t.qZA(),t.YNc(44,G,2,2,"mat-option",13),t.qZA(),t.TgZ(45,"mat-error"),t._uU(46),t.qZA()(),t.TgZ(47,"div",5)(48,"mat-label"),t._uU(49,"If your congregation is not in this list yet, please "),t.TgZ(50,"a",14),t._uU(51,"contact us"),t.qZA(),t._uU(52," to add it. "),t.qZA()()(),t.TgZ(53,"div",2)(54,"mat-form-field",15)(55,"mat-label"),t._uU(56,"Country"),t.qZA(),t.TgZ(57,"mat-select",16)(58,"mat-option"),t._uU(59,"Clear"),t.qZA(),t.YNc(60,Q,2,2,"mat-option",13),t.qZA(),t.TgZ(61,"mat-error"),t._uU(62),t.qZA()()(),t._UZ(63,"hr"),t.TgZ(64,"div",17),t._UZ(65,"input",18),t.TgZ(66,"input",19),t.NdJ("click",function(){return n.register()}),t.qZA()()()()()()),2&e&&(t.Q6J("title","Sign up"),t.xp6(4),t.Q6J("formGroup",n.mainForm),t.xp6(8),t.Q6J("ngIf",n.mainForm.get("name").value),t.xp6(2),t.hij(" ",n.getError("name")," "),t.xp6(5),t.Q6J("ngIf",n.mainForm.get("email").value),t.xp6(2),t.hij(" ",n.getError("email")," "),t.xp6(6),t.Q6J("ngIf",n.mainForm.get("username").value),t.xp6(2),t.hij(" ",n.getError("username")," "),t.xp6(5),t.Q6J("ngIf",n.mainForm.get("password").value),t.xp6(2),t.hij(" ",n.getError("password")," "),t.xp6(8),t.Q6J("ngForOf",n.congregations),t.xp6(2),t.hij(" ",n.getError("congregationId")," "),t.xp6(14),t.Q6J("ngForOf",n.countries),t.xp6(2),t.hij(" ",n.getError("countryId")," "),t.xp6(3),t.Q6J("routerLink",t.DdM(15,H)))},dependencies:[g.sg,g.O5,u.rH,u.Od,f.G,h.Hw,l.TO,l.KE,l.hX,l.R9,_.Nt,v.lW,M.gD,N.ey,r.Fj,r.JJ,r.JL,r.sg,r.u]}),o})()},{path:"forgot-password",component:q},{path:"reset-password",component:S}];let B=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.Bz.forChild(K),u.Bz]}),o})();var X=a(6633);let $=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,B,X.SharedComponentsModule]}),o})()}}]);